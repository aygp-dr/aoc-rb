# Advent of Code Ruby - direnv configuration
# Load Ruby version from .ruby-version via rbenv/rvm/asdf

# Ruby version manager detection and setup
if command -v rbenv &>/dev/null; then
  eval "$(rbenv init -)"
elif command -v rvm &>/dev/null; then
  source "$HOME/.rvm/scripts/rvm"
elif command -v asdf &>/dev/null; then
  source "$HOME/.asdf/asdf.sh"
fi

# Project-specific environment variables
export AOC_RUBY_ROOT="${PWD}"
export AOC_SESSION_FILE="${PWD}/.aoc_session"

# Add local bin to PATH
PATH_add bin

# Ruby bundler configuration
export BUNDLE_PATH="${PWD}/vendor/bundle"
export BUNDLE_BIN="${PWD}/vendor/bundle/bin"
PATH_add "${BUNDLE_BIN}"

# Use local Gemfile
layout ruby

# Check for required dependencies
has emacs || log_error "emacs not found"
has ruby || log_error "ruby not found"
has bundle || log_error "bundler not found - run: gem install bundler"
